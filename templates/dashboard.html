{% extends "base.html" %}

{% block title %}Mi lista de deseos{% endblock %}

{% block content %}
<div class="card">
  <h2>ğŸ“ Hola {{ user.name }} â€” Esta es tu lista de deseos ğŸ„</h2>
  <p>
    AquÃ­ escribe quÃ© te gustarÃ­a recibir en el intercambio.
    Solo la persona que te va a regalar podrÃ¡ verlo ğŸ¤«.
  </p>

  <form method="post" enctype="multipart/form-data">
    <!-- OPCIÃ“N 1 -->
    <label for="wish1">âœ¨ OpciÃ³n 1 (prioridad)</label>
    <textarea name="wish1" id="wish1" rows="2"
      placeholder="Ej. Sudadera Adidas talla M color negro">{{ my_wishes.wish1 if my_wishes else '' }}</textarea>

    <label for="wish1_img">ğŸ“¸ Foto de la opciÃ³n 1 (opcional)</label>
    <input type="file" name="wish1_img" id="wish1_img" accept="image/*">

    {% if my_wishes and my_wishes.wish1_img %}
      {% set img1 = my_wishes.wish1_img %}
      {% if img1.startswith('http') %}
        {% set img1_url = img1 %}
      {% else %}
        {% set img1_url = url_for('static', filename='uploads/' ~ img1) %}
      {% endif %}
      <div class="wish-option">
        <div class="wish-text">
          <strong>Vista previa de tu opciÃ³n 1</strong>
        </div>
        <img
          class="wish-img zoomable-image"
          src="{{ img1_url }}"
          data-full="{{ img1_url }}"
          alt="Mi opciÃ³n 1">
      </div>
    {% endif %}

    <hr style="margin: 20px 0; border: 0.5px solid rgba(255,255,255,0.15);">

    <!-- OPCIÃ“N 2 -->
    <label for="wish2">ğŸ OpciÃ³n 2 (por si no se encuentra la primera)</label>
    <textarea name="wish2" id="wish2" rows="2"
      placeholder="Ej. Perfume, libro, audÃ­fonos, etc.">{{ my_wishes.wish2 if my_wishes else '' }}</textarea>

    <label for="wish2_img">ğŸ“¸ Foto de la opciÃ³n 2 (opcional)</label>
    <input type="file" name="wish2_img" id="wish2_img" accept="image/*">

    {% if my_wishes and my_wishes.wish2_img %}
      {% set img2 = my_wishes.wish2_img %}
      {% if img2.startswith('http') %}
        {% set img2_url = img2 %}
      {% else %}
        {% set img2_url = url_for('static', filename='uploads/' ~ img2) %}
      {% endif %}
      <div class="wish-option">
        <div class="wish-text">
          <strong>Vista previa de tu opciÃ³n 2</strong>
        </div>
        <img
          class="wish-img zoomable-image"
          src="{{ img2_url }}"
          data-full="{{ img2_url }}"
          alt="Mi opciÃ³n 2">
      </div>
    {% endif %}

    <!-- BOTÃ“N GUARDAR / EDITAR -->
    <button type="submit">ğŸ’¾ Guardar / actualizar mi lista de deseos</button>
  </form>

  {% if my_wishes %}
    <!-- BOTÃ“N BORRAR LISTA DE DESEOS -->
    <form method="post"
          action="{{ url_for('delete_wishes') }}"
          style="margin-top: 12px;"
          onsubmit="return confirm('Â¿Seguro que quieres borrar toda tu lista de deseos (texto y fotos)?');">
      <button type="submit" class="btn-small btn-delete">
        ğŸ—‘ï¸ Borrar toda mi lista de deseos
      </button>
    </form>
  {% endif %}
</div>
{% endblock %}
