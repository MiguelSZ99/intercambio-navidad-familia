{% extends "base.html" %}

{% block title %}Comidas para la cena{% endblock %}

{% block content %}
<div class="card">
  <h2>ğŸ½ï¸ Comidas para el 24 de diciembre</h2>
  <p>
    AquÃ­ cada quien puede apuntar quÃ© platillo llevarÃ¡ a la cena y subir una foto de referencia.
  </p>

  <form method="post" enctype="multipart/form-data">
    <label for="person_name">Tu nombre (opcional si estÃ¡s logueado)</label>
    <input type="text" name="person_name" id="person_name" placeholder="Ej. Miguel"
           value="{{ user.name if user else '' }}">

    <label for="title">Nombre del platillo</label>
    <input type="text" name="title" id="title" placeholder="Ej. Lasagna, Ensalada de manzana" required>

    <label for="description">DescripciÃ³n (opcional)</label>
    <textarea name="description" id="description" rows="2"
              placeholder="Ingredientes, tamaÃ±o, por cuÃ¡ntas personas, etc."></textarea>

    <label for="food_img">Foto de referencia (opcional)</label>
    <input type="file" name="food_img" id="food_img" accept="image/*">

    <button type="submit">Registrar mi platillo</button>
  </form>
</div>

<div class="card">
  <h3>ğŸ“‹ Listado de platillos registrados</h3>

  {% if foods_list %}
    {% for food in foods_list %}
      <div class="wish-option">
        <div class="wish-text">
          <strong>{{ food.title }}</strong>
          &nbsp;â€” por {{ food.person_name }}
          {% if food.description %}
            <br>
            <span style="font-size:0.9rem; opacity:0.9;">
              {{ food.description }}
            </span>
          {% endif %}

          <div style="margin-top:8px; display:flex; gap:8px; flex-wrap:wrap;">
            <a href="{{ url_for('edit_food', food_id=food.id) }}"
               class="btn-small btn-edit">
              âœï¸ Editar
            </a>

            <form method="post"
                  action="{{ url_for('delete_food', food_id=food.id) }}"
                  onsubmit="return confirm('Â¿Seguro que quieres eliminar este platillo?');">
              <button type="submit" class="btn-small btn-delete">ğŸ—‘ï¸ Eliminar</button>
            </form>
          </div>
        </div>

        {% if food.image_filename %}
          <img
            class="wish-img"
            src="{{ url_for('static', filename='uploads/' ~ food.image_filename) }}"
            data-fullsrc="{{ url_for('static', filename='uploads/' ~ food.image_filename) }}"
            alt="Platillo de {{ food.person_name }}"
          >
        {% endif %}
      </div>
    {% endfor %}
  {% else %}
    <p>TodavÃ­a no hay platillos registrados. Â¡AnÃ³tate con el tuyo! ğŸ˜‹</p>
  {% endif %}
</div>
{% endblock %}
